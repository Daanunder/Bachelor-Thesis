# Background

To be able to refer the sensitivity of numerical errors produced by D-Flow FM to specific settings and parameters of the model a lock-exchange experiment is set up. In a lock-exhange the initial situation consists of a rectangular tank with a horizontal free water surface, for one half containing a fluid with a higher density than on the other half of the fluid tank, split vertically. In this research the density difference is caused by an initial salinity difference. At the start of the experiment (t=0) these fluids set in motion and from two wavefronts, a low- and high density front as a result of the gravitiational and buoyant forces. The numerical errors produced during such an experiment have often been investigated and this research aims to use the results obtained from this experiment as a measure for the order of accuracy of the D-Flow FM numerical flow model and a guide to avoid such errors in subsequent modelling.

Because D-Flow FM implements many complex details of a numerical scheme only a few important aspects are shortly described here. For further elaboration the reader is referred to Appendix B - D-Flow Flexible Mesh or [@DFlowTechMan]. D-Flow FM implements the shallow water equations that have as basic assumptions that the vertical velocity is small compared to horizontal scale, the vertical pressure is nearly hydrostatic and wave induced accelerations in the vertical cause negligible effect on the pressure distribution compared to the wave induced height difference. Further the shallow water equations have as property that the water density is directly proportional to bed- and wind friction terms. D-Flow FM uses an finite differences method with an upwind scheme (implicit) to solve the governing equations. Most importantly D-Flow is capable of implementing many sorts of meshgrid types, including triangles, quids, pentagons and hexagons in a curvilinear grid. 

![Basic lock-exchange setup - Source:@Shin2004\label{lock-exchange-setup}](./lock-exchange-setup.png)

In general finite differences based methods used to approximate convection-diffusion problems using the shallow water equations, the hydrostatic assumption causes errors related to vertical accelerations that can not be accounted for (i.e. vertical velocity gradients). Because the continuity equation can only account for small variations in the vertical velocity gradient when larger accelerations occur numerical models show physically unrealistic phenomena such as spurious oscillations in salinity profiles and, in the case of the lock-exchange esperiment, smaller propagations speeds of the two density fronts than would be expected based on the energy balance [@Pietrzak1998]. This is also experimentally confirmed as presented in @Simpson1998. Thus depending on the order of velocity varations in the vertical, given a specific timestep size and spatial resolution, the hydrostatic assumption can cause larger or smaller numerical errors. In practice this means the modelled flow should be more or less laminar which allows the solution to be smoothly varying and the continuity equation can account for the vertical velocity variations. Taking this into account, during a lock exchange experiment the largest errors may be expected near the density fronts and near the interface between the two density driven currents, due to respectively steep salinity gradients causing large discontinuities and high shear stresses causing turbulence thus vertical velocity gradient (also known as the Benard-Von Karman instability [@Mathis1984]).

![Lock-exchange experiment, flow over time - Source:@Garcia2019\label{lock-exchange-experiment}](./lock-exchange-experiment.jpg)

For most flows in a lock exchange, depending mostly on the Reynolds number [@Shin2004], resistance can be ignored. Also described in [@Battjes2017], when damping of wave amplitude is as little as possible the energy conserving assumption is most valid and uniform flow behind the wavefront can be assumed. By examening the flow based on the above assumptions, numerical errors may also be be recognized at times when the hydrostatic assumption is least valid. For example at t=0 because of the large initial disturbance, when a relatively large velocity gradient between the two sides of each front occurs, numerical dispersion could occur because the model struggles to account for these large gradients. Similarly at times when Benard-Von Karman instabilities are fully developed numerical diffusion may be significant, since the type of numerical models considered tend to flatten out these smaller-scale vertical velocity gradients. Lastly, if the frontal propagation speeds (the propagation velocity of the low- and high density front) does not comply with estimations as proposed by literature [@Pietrzak1998] it could be an indication of numerical diffusion.

**TODO: give formulae for shallow water equations, convection equation and numerical model**
**TODO: explain the courant number and other numerical conditions shortly**


